#- name: Install requirements with pip # TODO: this does not report any fail but doesnt really install tensorflow. If I then ssh into the vm and run this by hand: works perfectly. Besides that, sys.path is the same on both cases
#  environment:
#    PATH: /home/ubuntu/anaconda3/bin:{{ ansible_env.PATH }}
#    LD_LIBRARY_PATH: "/usr/lib64/openmpi/lib/:/usr/local/cuda/lib64:/usr/local/lib:/usr/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/mpi/lib:/lib/:"
#    PYTHONPATH: /home/ubuntu/progressive_growing_of_gans
#  pip:
#    requirements: ~/progressive_growing_of_gans/requirements-pip.txt

#- name: Install requirements with pip
#  environment:
#    PATH: /home/ubuntu/anaconda3/bin:{{ ansible_env.PATH }}
#    LD_LIBRARY_PATH: "/usr/lib64/openmpi/lib/:/usr/local/cuda/lib64:/usr/local/lib:/usr/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/mpi/lib:/lib/:"
#    PYTHONPATH: /home/ubuntu/progressive_growing_of_gans
#  pip:
#    name: tensorflow-gpu
      #- numpy>=1.13.3
      #- scipy>=1.0.0
      #- tensorflow-gpu==1.15.2
      #- moviepy>=0.2.3.2
      #- Pillow>=3.1.1
      #- lmdb>=0.93
      #- opencv-python>=3.4.0.12
      #- cryptography>=2.1.4
      #- h5py>=2.7.1
      #- six>=1.11.0

- name: Install requirements with pip # TODO: this works
  args:
    executable: /bin/bash
  environment:
    PATH: /home/ubuntu/anaconda3/bin:{{ ansible_env.PATH }}
    LD_LIBRARY_PATH: "/usr/lib64/openmpi/lib/:/usr/local/cuda/lib64:/usr/local/lib:/usr/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/mpi/lib:/lib/:"
    PYTHONPATH: /home/ubuntu/progressive_growing_of_gans
  shell: pip install -r ~/progressive_growing_of_gans/requirements-pip.txt
